<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Fvck avalon</title>
  </head>
  <body ms-controller="main">
    <div>
      current payment: <span ms-text="payment.name"></span>
    </div>

    <hr>

    <div ms-controller="payments">
      <p ms-repeat="items"><a href="javascript:;" ms-on-click="select(el)">{{el.name}}</a></p>
    </div>
    <script src="avalon.js"></script>
    <script>
      var main = avalon.define({
        $id: 'main',
        payment: {}
      });
      main.$watch('paymentSelected', function() {
        main.payment = avalon.vmodels.payments.selectedItem;
      });

      var payments = avalon.define({
        $id: 'payments',
        items: [],
        selectedItem: {},
        select: function(item) {
          payments.selectedItem = item//.$model;
          payments.$fire('up!paymentSelected');
        }
      });

      var items = [
        {name: 'M1'},
        {name: 'M2'}
      ];
      payments.items = items;
      payments.select(payments.items[0]);
    </script>
  </body>
</html>