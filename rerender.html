<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>avalon 2</title>
    <style type="text/css">
        div {
            color: blue;
        }
        *.a {
            color: red;
        }
    </style>
</head>
<body ms-controller="root">
    <button ms-if="@isLogin" ms-click="@lgout" ms-class="{'a': @isLogin}">成功</button>
    <h1>{{@page}}</h1>
    <input type="button" ms-click="@change($event)" value="change page" />
    <div ms-controller="first">
        <h2 ms-text="@page"></h2>
        <input type="button" ms-click="@change($event)" value="change page first" />
        <div ms-if="@page=='first'">
            <div ms-controller="second">
                <h3 ms-html="@page"></h3>
                <input ms-if="@isLogin" type="button" ms-click="@change($event)" value="change page second" />
                <div ms-if="@page == 'second'">
                   only show when @page equal 'second' - {{@page}} 
                   show kind@first - {{@kind}}
                </div>
            </div>
        </div>
    </div>
</body>
<script type="text/javascript" src="./dist/avalon.js"></script>
<script type="text/javascript">
    var root = avalon.define({
        $id: 'root',
        page: 'root',
        isLogin: false,
        level: 'root',
        lgout:function(){console.log('xxx')},
        change: function() {
            root.page = Math.random()
        }
    });
    var count2 = 0
    var first = avalon.define({
        $id: 'first',
        page: 'first2',
        age: 'first',
        kind: 'first',
        change: function () {
            console.log('first excute ' + count2++)
            if (first.page == 'first') {
                first.page = 100
            } else {
                first.page = 'first'
            }
        }
    });

    setTimeout(function(){
        root.isLogin=1;
    },500);
    var count = 0
    var second = avalon.define({
        $id: 'second',
        page: 'second',
        age: 'second',
        grade: "second",
        change: function () {
            console.log("second excute " + count++)
            if (second.page == 'second') {
                second.page = 1000
            } else {
                second.page = 'second'
            }
        }
    });
    avalon.scan(document.body)
</script>
</html>