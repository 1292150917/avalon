<!doctype html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Drag-Drop</title>
        <script src="../dist/avalon.js"></script>
        <script>
            function heredoc(fn) {
                return fn.toString().replace(/^[^\/]+\/\*!?\s?/, '').
                        replace(/\*\/[^\/]+$/, '').trim().replace(/>\s*</g, '><')
            }
            var v123 = heredoc(function () {
                /*
                 <fieldset ms-controller="test2">
                 <div id="dataTypeLayer" ms-html="@layerTpl"></div>
                 <button ms-click="@display">显示</button>
                 <xmp ms-skip style="display: none" id="addTpl1">
                 "模板1"
                 </xmp>
                 </fieldset>
                 */
            })
            var v456 = heredoc(function () {
                /*
                 <form ms-controller="test3">
                 <div id="dataTypeLayer" ms-html="@layerTpl"></div>
                 <button ms-click="@display |prevent">显示</button>
                 <xmp ms-skip style="display: none" id="addTpl2">
                 "模板2"
                 </xmp>
                 </form>
                 */
            })
            var vm = avalon.define({
                $id: 'test',
                tpl: "",
                switch1: function () {
                    vm.tpl = v123

                },
                switch2: function () {

                    vm.tpl = v456

                }
            })

            var vm2 = avalon.define({
                $id: 'test2',
                layerTpl: "vm2",
                display: function () {
                     console.log('test2.display')
                   // var text = document.querySelector("#addTpl1").innerHTML;
                  //  console.log(text)
                    this.layerTpl = new Date - 0//text
                }
            });

            var vm3 = avalon.define({
                $id: 'test3',
                layerTpl: "vm3",
                display: function () {
                    console.log('test3.display')
                  //  var text = document.querySelector("#addTpl2").innerHTML;
                 //   console.log(text)
                    this.layerTpl = "xxx" + (new Date - 0) //text
                }
            });
        </script>
    </head>
    <body ms-controller="test">
        <div ms-html="@tpl"></div>
        <button ms-click="@switch1">切换1</button>
        <button ms-click="@switch2">切换2</button>

    </body>
</html>