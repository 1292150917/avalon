<!DOCTYPE HTML>
<html>
    <head>
        <title>ms-on</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <script src="avalon.js" ></script>

    </head>
    <body>
        <script>
            function expect(a) {
                return {
                    to: {
                        be: function (b) {
                            console.log(a, b, a === b)
                        }
                    }
                }
            }
            function heredoc(fn) {
                return fn.toString().replace(/^[^\/]+\/\*!?\s?/, '').replace(/\*\/[^\/]+$/, '')
            }
  
            var m2 = avalon.define({
                $id: "test",
                fighters: []
            })
            var body = document.body
            var div = document.createElement("div")
            div.innerHTML = heredoc(function () {
                /*
                 <div ms-controller="test" id="getEachProxyBUG2">
                 <h1 ms-repeat="fighters">{{el}}</h1>
                 </div>'
                 */
            })
            body.appendChild(div)
            avalon.scan(div)

            setTimeout(function () {
                m2.fighters = ['su-35', 'su-22'];
            }, 500);
            setTimeout(function () {
                console.log("11111111111111111")
                m2.fighters.set(0, 'j-31')
                 m2.fighters.set(1, 'j-10')
            }, 1700);
            
           setTimeout(function () {
                console.log("11111111111111111")
                m2.fighters.set(0, 'j-3111')
                 m2.fighters.set(1, 'j-1222')
            }, 3700);
//            setTimeout(function () {
//                var els = div.getElementsByTagName("h1")
//                var prop = "textContent" in div ? "textContent" : "innerText"
//              //  expect(els.length).to.be(2)
//                expect(els[0][prop]).to.be("j-31")
//                expect(els[1][prop]).to.be("j-10")
//                //   clearTest("getEachProxyBUG1", div, done)
//                //  delete avalon.vmodels.getEachProxyBUG2
//            }, 900);
        </script>
    </body>
</html>
